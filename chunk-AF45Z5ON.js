import{a as X}from"./chunk-2A7TADK6.js";import{A as k,B as x,E as J,F as K,G as W,c as N,d as j,e as M,f as H,h as c,i as q,j as z,v as R,w as Q,x as Y,y as G,z as U}from"./chunk-WOELEOYT.js";import{f as $}from"./chunk-J2JYHL4Y.js";import"./chunk-SPBOXIZ7.js";import{a as Z,b as ee,c as te,d as ie,e as oe,f as re,g as ne,h as S}from"./chunk-VC4D4WTY.js";import"./chunk-LO27TSUG.js";import"./chunk-PMIXLXAC.js";import"./chunk-KDU5HLWA.js";import"./chunk-QZ6TUUVK.js";import"./chunk-W346UYTL.js";import"./chunk-PA4I2Q35.js";import"./chunk-MTU6N4QK.js";import"./chunk-YFSL42WZ.js";import{e as u,g as p}from"./chunk-7FV6G4R4.js";import"./chunk-4YRY4IP2.js";import"./chunk-FRVBFDPB.js";import{l as O,m as L}from"./chunk-ZWB3OEA7.js";import"./chunk-SPWQV7SM.js";import"./chunk-R4K2WD2X.js";import{d as A}from"./chunk-E7PRHJWB.js";import{t as I,x as V}from"./chunk-XJBCGK7A.js";import{Cb as m,Ib as a,Jb as d,Kb as F,Nb as w,Rb as f,a as y,c as E,hb as l,hc as P,ib as s,ic as D,m as g,ra as T,sc as v,tb as B,tc as C}from"./chunk-UXABPLNP.js";import{a as h,b as _}from"./chunk-MON7YFGF.js";var b=function(o){return o.offer_id="offer_id",o.title="title",o.description="description",o.discount_percentage="discount_percentage",o.discount_value="discount_value",o.valid_from="valid_from",o.valid_until="valid_until",o.minimum_order_value="minimum_order_value",o.applied_to_products="applied_to_products",o.applied_to_categories="applied_to_categories",o.created_by="created_by",o.status="status",o.created_at="created_at",o.updated_at="updated_at",o}(b||{});var qe=(()=>{class o extends X{constructor(i,e,t,n,r,se,ae,de){super(),this.headerConfigService=i,this.tableConfigService=e,this.offersStore=t,this.formBuilderService=n,this.dialogService=r,this.messageService=se,this.confirmationService=ae,this.formBuilderPrimengService=de,this.sharedHeaderComponentConfig={},this.sharedTableComponentConfig={},this.offersList=[],this.offersList$=new E,this.totalData$=this.offersStore.pipe(L(ne)),this.fetchFilterdListSubscribe=new y,this.offerEnum=b,t.select(S).subscribe(fe=>{this.offersList=fe.data,this.createConfigurationForTheSharedTableComponent()})}ngOnInit(){this.loadData(),this.selectOffersStore(),this.createConfigurationForTheSharedHeaderComponent(),this.createConfigurationForTheSharedTableComponent()}loadData(){console.log("loadOffers this.pageEvent --------->",this.pageEvent),this.constructRequest(),this.dispatchRequest(this.request)}dispatchRequest(i){this.offersStore.dispatch(Z({request:this.request,pageNo:this.pageEvent.page,pageSize:this.pageEvent.rows,sortBy:this.sortBy,sortOrder:this.sortOrder,filterBy:this.filterBy,filterValue:this.filterValue,findById:this.findById}))}selectOffersStore(){this.offersList$=this.offersStore.select(re)}createConfigurationForTheSharedHeaderComponent(){this.sharedHeaderComponentConfig=this.headerConfigService.createConfig(new N().setTitle("Offer").setShowHeader(!0).setShowTitle(!0).setShowAddButton(!0).setShowEditButton(!1).setShowDeleteButton(!1).setCustomClass("dynamic-class"))}createConfigurationForTheSharedTableComponent(){this.sharedTableComponentConfig=this.tableConfigService.createConfig(new G().setTitle("Offer").setViewType(this.viewType).setShowHeader(!0).setShowFooter(!1).setCustomClass("dynamic-class").setData(this.offersList).setTableHeader(["id",this.offerEnum.title,this.offerEnum.description,this.offerEnum.applied_to_categories,this.offerEnum.applied_to_products,this.offerEnum.discount_percentage,this.offerEnum.discount_value,this.offerEnum.minimum_order_value,this.offerEnum.valid_from,this.offerEnum.valid_until,this.offerEnum.created_by,this.offerEnum.created_at,this.offerEnum.updated_at]).setDataList(this.offersList$))}createConfigurationForFormBuilderComponent(){this.formBuilderPrimengService.addPInputTextField(this.offerEnum.title,this.offerEnum.title,`Enter ${this.offerEnum.title}`,!0).addPMultiSelectField(this.offerEnum.applied_to_categories,this.offerEnum.applied_to_categories,g([{id:0,name:"All Categories"}]),!0).addPMultiSelectField(this.offerEnum.applied_to_products,this.offerEnum.applied_to_products,g([{id:0,name:"All Products"}]),!0).addPInputNumberField(this.offerEnum.discount_percentage,this.offerEnum.discount_percentage,`Enter ${this.offerEnum.discount_percentage}`,!0).addPInputNumberField(this.offerEnum.discount_value,this.offerEnum.discount_value,`Enter ${this.offerEnum.discount_value}`,!0).addPInputNumberField(this.offerEnum.minimum_order_value,this.offerEnum.minimum_order_value,`Enter ${this.offerEnum.minimum_order_value}`,!0).addPCalendarField(this.offerEnum.valid_from,this.offerEnum.valid_from,`Enter ${this.offerEnum.valid_from}`,!0).addPCalendarField(this.offerEnum.valid_until,this.offerEnum.valid_until,`Enter ${this.offerEnum.valid_until}`,!0).addPInputTextField(this.offerEnum.description,this.offerEnum.description,`Enter ${this.offerEnum.description}`,!0)}onAddNewBtn(i){this.createConfigurationForFormBuilderComponent(),this.ref=this.dialogService.open(Q,{header:"Create Offer",width:"40vw",modal:!0,closable:!0,contentStyle:{overflow:"auto"},data:{formFields:"this.formBuilderService.getFormFields()"}}),this.ref.onClose.subscribe(e=>{console.log("onClose",e),e&&this.offersStore.dispatch(te({offer:e}));let t;if(e){let n=e?.buttonType;t=n?{summary:"No Product Selected",detail:`Pressed '${n}' button`}:{summary:"Product Selected",detail:e?.name}}else t={summary:"No Product Selected",detail:"Pressed Close button"};this.messageService.add(_(h({severity:"info"},t),{life:3e3}))}),this.ref.onMaximize.subscribe(e=>{this.messageService.add({severity:"info",summary:"Maximized",detail:`maximized: ${e.maximized}`})})}onEditBtn(i){}onDeleteBtn(i){}onView(i){}onEdit(i){this.ref=this.dialogService.open(z,{header:"Update Offer "+i.data.title,width:"40vw",modal:!0,closable:!0,contentStyle:{overflow:"auto"},data:{formFieldsValues:i.data}}),this.ref.onClose.subscribe(e=>{e&&(e.id=i.id,e._id=i.id,this.offersStore.dispatch(ie({id:e.id,newItem:e})));let t;if(e){let n=e?.buttonType;t=n?{summary:"No Product Selected",detail:`Pressed '${n}' button`}:{summary:"Product Selected",detail:e?.name}}else t={summary:"No Product Selected",detail:"Pressed Close button"};this.messageService.add(_(h({severity:"info"},t),{life:3e3}))})}onDelete(i){this.confirmationService.confirm({message:"Are you sure that you want to ?",header:"Confirmation",icon:"pi pi-exclamation-triangle",acceptIcon:"none",rejectIcon:"none",rejectButtonStyleClass:"p-button-text",accept:()=>{this.messageService.add({severity:"info",summary:"Confirmed",detail:"You have accepted"}),this.offersStore.dispatch(oe({offerId:i.id}))},reject:()=>{this.messageService.add({severity:"error",summary:"Rejected",detail:"You have rejected",life:3e3})}})}filterQueryValues(i){console.log("filterQueryValues",i),this.offersStore.dispatch(ee({request:i,pageNo:this.pageEvent.page,pageSize:this.pageEvent.rows})),this.fetchFilterdListSubscribe&&this.fetchFilterdListSubscribe.unsubscribe(),this.fetchFilterdListSubscribe=this.offersStore.select(S).subscribe(e=>{console.log("fetchFilterdList --------->",e)})}onChangeViewType(i){console.log("onChangeViewType",i),this.viewType=i,this.createConfigurationForTheSharedTableComponent()}onPagePaginatorChange(i){this.pageEvent=i,this.loadData()}ngOnDestroy(){this.fetchFilterdListSubscribe&&this.fetchFilterdListSubscribe.unsubscribe()}static{this.\u0275fac=function(e){return new(e||o)(s(j),s(U),s(O),s(q),s(c),s(p),s(u),s(R))}}static{this.\u0275cmp=T({type:o,selectors:[["app-offers"]],standalone:!0,features:[P([c,p,u]),B,D],decls:9,vars:8,consts:[[3,"onAddNewBtn","onEditBtn","onDeleteBtn","config"],[3,"filterFormvalues","viewTypeValue"],[3,"onViewBtn","onEditBtn","onDeleteBtn","config","length"],["TabelContent",""],[3,"onPagePaginatorChange","length"]],template:function(e,t){e&1&&(F(0,"p-toast")(1,"p-confirmDialog"),a(2,"app-component-header",0),f("onAddNewBtn",function(r){return t.onAddNewBtn(r)})("onEditBtn",function(r){return t.onEditBtn(r)})("onDeleteBtn",function(r){return t.onDeleteBtn(r)}),d(),a(3,"app-filters",1),f("filterFormvalues",function(r){return t.filterQueryValues(r)})("viewTypeValue",function(r){return t.onChangeViewType(r)}),d(),a(4,"app-table-container",2),v(5,"async"),f("onViewBtn",function(r){return t.onView(r)})("onEditBtn",function(r){return t.onEdit(r)})("onDeleteBtn",function(r){return t.onDelete(r)}),w(6,3),d(),a(7,"app-paginator",4),v(8,"async"),f("onPagePaginatorChange",function(r){return t.onPagePaginatorChange(r)}),d()),e&2&&(l(2),m("config",t.sharedHeaderComponentConfig),l(2),m("config",t.sharedTableComponentConfig)("length",C(5,4,t.totalData$)||0),l(3),m("length",C(8,6,t.totalData$)||0))},dependencies:[V,I,A,M,H,Y,W,K,J,x,k,$]})}}return o})();export{qe as OffersComponent};
