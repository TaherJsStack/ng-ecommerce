import{a as W,b as X,c as Z,d as x,e as ee,f as te,g as ie,h as _}from"./chunk-WFDZBY2B.js";import{a as K}from"./chunk-24LY6ISI.js";import"./chunk-G7GKDBDS.js";import{c as M,d as N,e as R,f as $,g as h,h as q,i as C,l as z,m as O,n as Q,o as Y,p as G,q as U,r as k,s as J}from"./chunk-ZHE3RQP7.js";import"./chunk-DVDV44HM.js";import{f as H}from"./chunk-HVR775ON.js";import"./chunk-4V5UOZBX.js";import"./chunk-XNY2RDZO.js";import"./chunk-7NOMDU42.js";import{l as L,m as j}from"./chunk-VHK6HW5T.js";import{d as I}from"./chunk-OJYRZGEA.js";import"./chunk-DQONCCFF.js";import"./chunk-EQUQ7CBC.js";import{e as p,g as u}from"./chunk-XZNJALMM.js";import{l as V,o as A}from"./chunk-CBDC4O62.js";import{Eb as a,Fb as l,Gb as F,Jb as P,Nb as d,a as b,c as y,db as m,dc as D,eb as s,ec as E,nc as g,oa as T,oc as w,pb as B,yb as c}from"./chunk-WWR4BG2S.js";import{a as f,b as v}from"./chunk-MON7YFGF.js";var S=function(n){return n.review_id="review_id",n.product_id="product_id",n.user_id="user_id",n.rating="rating",n.comment="comment",n.created_at="created_at",n.updated_at="updated_at",n.helpful_count="helpful_count",n.report_count="report_count",n}(S||{});var He=(()=>{class n extends K{constructor(i,e,t,r,o,oe,re){super(),this.headerConfigService=i,this.tableConfigService=e,this.reviewsStore=t,this.formBuilderService=r,this.dialogService=o,this.messageService=oe,this.confirmationService=re,this.sharedHeaderComponentConfig={},this.sharedTableComponentConfig={},this.reviewsList=[],this.reviewsList$=new y,this.totalData$=this.reviewsStore.pipe(j(ie)),this.fetchFilterdListSubscribe=new b,this.reviewEnum=S,t.select(_).subscribe(ne=>{this.reviewsList=ne.data,this.createConfigurationForTheSharedTableComponent()})}ngOnInit(){this.loadData(),this.selectReviewsStore(),this.createConfigurationForTheSharedHeaderComponent(),this.createConfigurationForTheSharedTableComponent(),this.createConfigurationForFormBuilderComponent()}loadData(){console.log("loadReviews this.pageEvent --------->",this.pageEvent),this.constructRequest(),this.dispatchRequest(this.request)}dispatchRequest(i){this.reviewsStore.dispatch(W({request:this.request,pageNo:this.pageEvent.page,pageSize:this.pageEvent.rows,sortBy:this.sortBy,sortOrder:this.sortOrder,filterBy:this.filterBy,filterValue:this.filterValue,findById:this.findById}))}selectReviewsStore(){this.reviewsList$=this.reviewsStore.select(te)}createConfigurationForTheSharedHeaderComponent(){this.sharedHeaderComponentConfig=this.headerConfigService.createConfig(new M().setTitle("Review").setShowHeader(!0).setShowTitle(!0).setShowAddButton(!1).setShowEditButton(!1).setShowDeleteButton(!1).setCustomClass("dynamic-class"))}createConfigurationForTheSharedTableComponent(){this.sharedTableComponentConfig=this.tableConfigService.createConfig(new O().setTitle("Review").setViewType(this.viewType).setShowHeader(!0).setShowFooter(!1).setCustomClass("dynamic-class").setData(this.reviewsList).setTableHeader(["id",this.reviewEnum.comment,this.reviewEnum.rating,this.reviewEnum.user_id,this.reviewEnum.helpful_count,this.reviewEnum.product_id,this.reviewEnum.report_count,this.reviewEnum.created_at,this.reviewEnum.updated_at]).setDataList(this.reviewsList$))}createConfigurationForFormBuilderComponent(){this.formBuilderService.addTextField(this.reviewEnum.comment,this.reviewEnum.comment,`Enter ${this.reviewEnum.comment}`,!0)}onAddNewBtn(i){this.ref=this.dialogService.open(C,{header:"Create Review",width:"40vw",modal:!0,closable:!0,contentStyle:{overflow:"auto"},data:{formFields:"this.formBuilderService.getFormFields()"}}),this.ref.onClose.subscribe(e=>{console.log("onClose",e),e&&this.reviewsStore.dispatch(Z({review:e}));let t;if(e){let r=e?.buttonType;t=r?{summary:"No Product Selected",detail:`Pressed '${r}' button`}:{summary:"Product Selected",detail:e?.name}}else t={summary:"No Product Selected",detail:"Pressed Close button"};this.messageService.add(v(f({severity:"info"},t),{life:3e3}))}),this.ref.onMaximize.subscribe(e=>{this.messageService.add({severity:"info",summary:"Maximized",detail:`maximized: ${e.maximized}`})})}onEditBtn(i){}onDeleteBtn(i){}onView(i){}onEdit(i){this.ref=this.dialogService.open(C,{header:"Update Review "+i.data.comment,width:"40vw",modal:!0,closable:!0,contentStyle:{overflow:"auto"},data:{formFieldsValues:i.data}}),this.ref.onClose.subscribe(e=>{e&&(e.id=i.id,e._id=i.id,this.reviewsStore.dispatch(x({id:e.id,newItem:e})));let t;if(e){let r=e?.buttonType;t=r?{summary:"No Product Selected",detail:`Pressed '${r}' button`}:{summary:"Product Selected",detail:e?.name}}else t={summary:"No Product Selected",detail:"Pressed Close button"};this.messageService.add(v(f({severity:"info"},t),{life:3e3}))})}onDelete(i){this.confirmationService.confirm({message:"Are you sure that you want to ?",header:"Confirmation",icon:"pi pi-exclamation-triangle",acceptIcon:"none",rejectIcon:"none",rejectButtonStyleClass:"p-button-text",accept:()=>{this.messageService.add({severity:"info",summary:"Confirmed",detail:"You have accepted"}),this.reviewsStore.dispatch(ee({reviewId:i.id}))},reject:()=>{this.messageService.add({severity:"error",summary:"Rejected",detail:"You have rejected",life:3e3})}})}filterQueryValues(i){console.log("filterQueryValues",i),this.reviewsStore.dispatch(X({request:i,pageNo:this.pageEvent.page,pageSize:this.pageEvent.rows})),this.fetchFilterdListSubscribe&&this.fetchFilterdListSubscribe.unsubscribe(),this.fetchFilterdListSubscribe=this.reviewsStore.select(_).subscribe(e=>{console.log("fetchFilterdList --------->",e)})}onChangeViewType(i){console.log("onChangeViewType",i),this.viewType=i,this.createConfigurationForTheSharedTableComponent()}onPagePaginatorChange(i){this.pageEvent=i,this.loadData()}ngOnDestroy(){this.fetchFilterdListSubscribe&&this.fetchFilterdListSubscribe.unsubscribe()}static{this.\u0275fac=function(e){return new(e||n)(s(N),s(Q),s(L),s(q),s(h),s(u),s(p))}}static{this.\u0275cmp=T({type:n,selectors:[["app-previews"]],standalone:!0,features:[D([h,u,p]),B,E],decls:9,vars:8,consts:[[3,"onAddNewBtn","onEditBtn","onDeleteBtn","config"],[3,"filterFormvalues","viewTypeValue"],[3,"onViewBtn","onEditBtn","onDeleteBtn","config","length"],["TabelContent",""],[3,"onPagePaginatorChange","length"]],template:function(e,t){e&1&&(F(0,"p-toast")(1,"p-confirmDialog"),a(2,"app-component-header",0),d("onAddNewBtn",function(o){return t.onAddNewBtn(o)})("onEditBtn",function(o){return t.onEditBtn(o)})("onDeleteBtn",function(o){return t.onDeleteBtn(o)}),l(),a(3,"app-filters",1),d("filterFormvalues",function(o){return t.filterQueryValues(o)})("viewTypeValue",function(o){return t.onChangeViewType(o)}),l(),a(4,"app-table-container",2),g(5,"async"),d("onViewBtn",function(o){return t.onView(o)})("onEditBtn",function(o){return t.onEdit(o)})("onDeleteBtn",function(o){return t.onDelete(o)}),P(6,3),l(),a(7,"app-paginator",4),g(8,"async"),d("onPagePaginatorChange",function(o){return t.onPagePaginatorChange(o)}),l()),e&2&&(m(2),c("config",t.sharedHeaderComponentConfig),m(2),c("config",t.sharedTableComponentConfig)("length",w(5,4,t.totalData$)||0),m(3),c("length",w(8,6,t.totalData$)||0))},dependencies:[A,V,I,R,$,z,J,k,U,G,Y,H]})}}return n})();export{He as PreviewsComponent};
