import{a as S,b as v,c as x,e as H,f as N,g as V,h as D,i as G,j as J,k as F,l as K,m as Q,n as b,o as W,p as d,q as P}from"./chunk-OFM7LE7T.js";import{a as y,b as k,c as A,f as z,g as B}from"./chunk-G7GKDBDS.js";import{a as M}from"./chunk-7NOMDU42.js";import{l as O,m as q,s as m,t as T}from"./chunk-VHK6HW5T.js";import{r as L}from"./chunk-CBDC4O62.js";import{B as h,K as w,Z as E,_,ca as j,g as U,ha as f,m as c,r as u,t as $}from"./chunk-WWR4BG2S.js";import{a as p,b as l}from"./chunk-MON7YFGF.js";var I=M,X=(()=>{class e extends z{constructor(r){super(r),this.clientDataSubject=new U([]),this.clientData$=this.clientDataSubject.asObservable()}create(r){return this.http.post(`${I.API_URL}categories.json`,r)}getAllItems(r){let{queryParams:s}=this.initializeRequest(r);return this.http.get(`${I.API_URL}categories.json`).pipe(E(n=>{this.clientDataSubject.next(n.data)}))}updateItem(r,s){return this.http.put(`${I.API_URL}categories.json`,s)}deleteItem(r){return this.http.delete(`${I.API_URL}categories.json`)}getItem(r){throw new Error("Method not implemented.")}search(r,s){let{queryParams:n}=this.initializeRequest(s);return this.http.get(`${I.API_URL}/categories/search/${r}?${n}`)}static{this.\u0275fac=function(s){return new(s||e)(f(L))}}static{this.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var de=(()=>{class e{constructor(r,s,n){this.actions$=r,this.categoriesService=s,this.store=n,this.getAllItems$=y(()=>this.actions$.pipe(A(S),_(this.store.pipe(q(P))),w(([o,i])=>i.length===0?this.categoriesService.getAllItems(o.request).pipe(u(t=>{let C=t.data.map(g=>l(p({},g),{id:g.category_id,_id:g.category_id})),R=t.totalData;return v({categories:C,totalData:R})}),h(t=>c(x({error:t})))):c()))),this.getFilterdItems$=y(()=>this.actions$.pipe(A(S),_(this.store.pipe(q(P))),w(([o,i])=>(console.log("data --->",i,o),i.length===0?this.categoriesService.getAllItems(o.request).pipe(u(t=>{let C=t.data.map(g=>l(p({},g),{id:g.category_id,_id:g.category_id})),R=t.totalData;return H({categories:C,totalData:R})}),h(t=>c(N({error:t})))):c())))),this.createCategory$=y(()=>this.actions$.pipe(A(V),$(({category:o})=>this.categoriesService.create(o).pipe(u(i=>{let t=i.data[0];return t.id=new Date().getTime().toString(),t._id=new Date().getTime().toString(),t.category_id=new Date().getTime().toString(),D({category:t})}),h(i=>c(G({error:i}))))))),this.updateCategory$=y(()=>this.actions$.pipe(A(J),$(({id:o,newItem:i})=>this.categoriesService.updateItem(o,i).pipe(u(t=>{let C=t.data[0];return F({category:C})}),h(t=>c(K({error:t}))))))),this.deleteCategory$=y(()=>this.actions$.pipe(A(Q),$(({categoryId:o})=>this.categoriesService.deleteItem(o).pipe(u(()=>b({categoryId:o})),h(i=>c(W({error:i})))))))}static{this.\u0275fac=function(s){return new(s||e)(f(k),f(X),f(O))}}static{this.\u0275prov=j({token:e,factory:e.\u0275fac})}}return e})();var Y=d.getInitialState(new B);var $e=T(Y,m(S,(e,{pageNo:a,pageSize:r,sortBy:s,sortOrder:n,filterBy:o,filterValue:i,findById:t})=>l(p({},e),{pageNo:a,pageSize:r,loading:!0,error:null,sortBy:s,sortOrder:n,filterBy:o,filterValue:i,findById:t})),m(v,(e,{categories:a,totalData:r})=>d.setAll(a,l(p({},e),{totalData:r,loading:!1}))),m(x,(e,{error:a})=>l(p({},e),{error:a,loading:!1})),m(D,(e,{category:a})=>d.addOne(a,e)),m(F,(e,{category:a})=>d.updateOne({id:a._id,changes:a},e)),m(b,(e,{categoryId:a})=>d.removeOne(a,e)));export{de as a,$e as b};
