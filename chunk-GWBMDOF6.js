import{a as _,b,c as D,d as q,e as G,f as J,g as K,h as O,i as k,j as Q,k as y,l as W,m as X,n as U,o as Y,p as Z,q as w,r as tt,s as m,t as L}from"./chunk-AQZREA66.js";import{a as A,b as H,c as S,e as T,f as V}from"./chunk-Y2HYYDXH.js";import{l as C,m as x,s as n,t as M}from"./chunk-7C3VAOG7.js";import{a as N}from"./chunk-P7IJNKWV.js";import{F as E}from"./chunk-EEICXFOG.js";import{$ as v,C as f,L as F,_ as B,da as R,g as z,ia as $,m as p,r as P,t as j}from"./chunk-GCV2IDJ5.js";import{a as u,b as a}from"./chunk-MON7YFGF.js";var I=N,et=(()=>{class t extends T{constructor(r){super(r),this.clientDataSubject=new z([]),this.clientData$=this.clientDataSubject.asObservable()}create(r){return this.http.post(`${I.API_URL}products.json`,r)}getAllItems(r){let{queryParams:i}=this.initializeRequest(r);return this.http.get(`${I.API_URL}products.json`).pipe(B(l=>{this.clientDataSubject.next(l.data)}))}updateItem(r,i){return this.http.put(`${I.API_URL}products.json`,i)}deleteItem(r){return this.http.delete(`${I.API_URL}products.json`)}getItem(r){return this.http.delete(`${I.API_URL}products.json`)}checkProduct(r){let i={};i.phone=r,i.pageNo=50;let{queryParams:l}=this.initializeRequest(i);return this.http.get(`${I.API_URL}/products/check-phone/${r}?${l}`)}search(r,i){let{queryParams:l}=this.initializeRequest(i);return this.http.get(`${I.API_URL}/products/search/${r}?${l}`)}static{this.\u0275fac=function(i){return new(i||t)($(E))}}static{this.\u0275prov=R({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var At=(()=>{class t{constructor(r,i,l){this.actions$=r,this.productsService=i,this.store=l,this.getAllItems$=A(()=>this.actions$.pipe(S(_),v(this.store.pipe(x(L))),F(([s,c])=>c.length===0?this.productsService.getAllItems(s.request).pipe(P(e=>{let h=e.data.map(d=>a(u({},d),{id:d.product_id,_id:d.product_id})),g=e.totalData;return b({products:h,totalData:g})}),f(e=>p(D({error:e})))):p()))),this.getFilterdItems$=A(()=>this.actions$.pipe(S(K),v(this.store.pipe(x(L))),F(([s,c])=>c.length===0?this.productsService.getAllItems(s.request).pipe(P(e=>{let h=e.data.map(d=>a(u({},d),{id:d.product_id,_id:d.product_id})),g=e.totalData;return O({product:h,totalData:g})}),f(e=>p(k({error:e})))):p()))),this.getItem$=A(()=>this.actions$.pipe(S(q),v(this.store.pipe(x(L))),F(([s,c])=>c.length===0?this.productsService.getItem(s.findById).pipe(P(e=>{let h=e.data.map(d=>a(u({},d),{id:d.product_id,_id:d.product_id})),g=e.totalData;return O({product:h,totalData:g})}),f(e=>p(k({error:e})))):p()))),this.createProduct$=A(()=>this.actions$.pipe(S(Q),j(({product:s})=>this.productsService.create(s).pipe(P(c=>{let e=c.data[0];return y({product:e})}),f(c=>p(W({error:c}))))))),this.updateProduct$=A(()=>this.actions$.pipe(S(X),j(({id:s,newItem:c})=>this.productsService.updateItem(s,c).pipe(P(e=>{let h=e.data[0];return U({product:h})}),f(e=>p(Y({error:e}))))))),this.deleteProduct$=A(()=>this.actions$.pipe(S(Z),j(({productId:s})=>this.productsService.deleteItem(s).pipe(P(()=>w({productId:s})),f(c=>p(tt({error:c})))))))}static{this.\u0275fac=function(i){return new(i||t)($(H),$(et),$(C))}}static{this.\u0275prov=R({token:t,factory:t.\u0275fac})}}return t})();var rt=m.getInitialState(new V);var xt=M(rt,n(_,(t,{pageNo:o,pageSize:r,sortBy:i,sortOrder:l,filterBy:s,filterValue:c,findById:e})=>a(u({},t),{pageNo:o,pageSize:r,loading:!0,error:null,sortBy:i,sortOrder:l,filterBy:s,filterValue:c,findById:e})),n(b,(t,{products:o,totalData:r})=>m.setAll(o,a(u({},t),{totalData:r,loading:!1}))),n(D,(t,{error:o})=>a(u({},t),{error:o,loading:!1})),n(q,(t,{findById:o})=>a(u({},t),{loading:!0,error:null,findById:o})),n(G,(t,{product:o})=>m.addOne(o,a(u({},t),{loading:!1}))),n(J,(t,{error:o})=>a(u({},t),{error:o,loading:!1})),n(y,(t,{product:o})=>m.addOne(o,t)),n(U,(t,{product:o})=>m.updateOne({id:o._id,changes:o},t)),n(w,(t,{productId:o})=>m.removeOne(o,t)));export{At as a,xt as b};
