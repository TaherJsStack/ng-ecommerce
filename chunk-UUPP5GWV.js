import{a as A,b as Y,c as S,e as Z,f as tt}from"./chunk-5SPO2ULR.js";import{a as N}from"./chunk-GL5CIJKG.js";import{a as _,b,c as D,d as q,e as H,f as T,g as V,h as O,i as k,j as G,k as y,l as J,m as K,n as U,o as Q,p as W,q as w,r as X,s as m,t as L}from"./chunk-QIWOYWJC.js";import{l as C,m as x,s as n,t as M}from"./chunk-5JVEGXLZ.js";import{b as E}from"./chunk-I3TFT3JE.js";import{C as f,N as F,aa as B,ba as v,fa as R,g as z,ka as $,m as p,r as P,t as j}from"./chunk-W3XNKEV5.js";import{a as u,b as a}from"./chunk-MON7YFGF.js";var I=N,et=(()=>{class t extends Z{constructor(r){super(r),this.clientDataSubject=new z([]),this.clientData$=this.clientDataSubject.asObservable()}create(r){return this.http.post(`${I.API_URL}products.json`,r)}getAllItems(r){let{queryParams:i}=this.initializeRequest(r);return this.http.get(`${I.API_URL}products.json`).pipe(B(l=>{this.clientDataSubject.next(l.data)}))}updateItem(r,i){return this.http.put(`${I.API_URL}products.json`,i)}deleteItem(r){return this.http.delete(`${I.API_URL}products.json`)}getItem(r){return this.http.delete(`${I.API_URL}products.json`)}checkProduct(r){let i={};i.phone=r,i.pageNo=50;let{queryParams:l}=this.initializeRequest(i);return this.http.get(`${I.API_URL}/products/check-phone/${r}?${l}`)}search(r,i){let{queryParams:l}=this.initializeRequest(i);return this.http.get(`${I.API_URL}/products/search/${r}?${l}`)}static{this.\u0275fac=function(i){return new(i||t)($(E))}}static{this.\u0275prov=R({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var At=(()=>{class t{constructor(r,i,l){this.actions$=r,this.productsService=i,this.store=l,this.getAllItems$=A(()=>this.actions$.pipe(S(_),v(this.store.pipe(x(L))),F(([s,c])=>c.length===0?this.productsService.getAllItems(s.request).pipe(P(e=>{let h=e.data.map(d=>a(u({},d),{id:d.product_id,_id:d.product_id})),g=e.totalData;return b({products:h,totalData:g})}),f(e=>p(D({error:e})))):p()))),this.getFilterdItems$=A(()=>this.actions$.pipe(S(V),v(this.store.pipe(x(L))),F(([s,c])=>c.length===0?this.productsService.getAllItems(s.request).pipe(P(e=>{let h=e.data.map(d=>a(u({},d),{id:d.product_id,_id:d.product_id})),g=e.totalData;return O({product:h,totalData:g})}),f(e=>p(k({error:e})))):p()))),this.getItem$=A(()=>this.actions$.pipe(S(q),v(this.store.pipe(x(L))),F(([s,c])=>c.length===0?this.productsService.getItem(s.findById).pipe(P(e=>{let h=e.data.map(d=>a(u({},d),{id:d.product_id,_id:d.product_id})),g=e.totalData;return O({product:h,totalData:g})}),f(e=>p(k({error:e})))):p()))),this.createProduct$=A(()=>this.actions$.pipe(S(G),j(({product:s})=>this.productsService.create(s).pipe(P(c=>{let e=c.data[0];return y({product:e})}),f(c=>p(J({error:c}))))))),this.updateProduct$=A(()=>this.actions$.pipe(S(K),j(({id:s,newItem:c})=>this.productsService.updateItem(s,c).pipe(P(e=>{let h=e.data[0];return U({product:h})}),f(e=>p(Q({error:e}))))))),this.deleteProduct$=A(()=>this.actions$.pipe(S(W),j(({productId:s})=>this.productsService.deleteItem(s).pipe(P(()=>w({productId:s})),f(c=>p(X({error:c})))))))}static{this.\u0275fac=function(i){return new(i||t)($(Y),$(et),$(C))}}static{this.\u0275prov=R({token:t,factory:t.\u0275fac})}}return t})();var rt=m.getInitialState(new tt);var xt=M(rt,n(_,(t,{pageNo:o,pageSize:r,sortBy:i,sortOrder:l,filterBy:s,filterValue:c,findById:e})=>a(u({},t),{pageNo:o,pageSize:r,loading:!0,error:null,sortBy:i,sortOrder:l,filterBy:s,filterValue:c,findById:e})),n(b,(t,{products:o,totalData:r})=>m.setAll(o,a(u({},t),{totalData:r,loading:!1}))),n(D,(t,{error:o})=>a(u({},t),{error:o,loading:!1})),n(q,(t,{findById:o})=>a(u({},t),{loading:!0,error:null,findById:o})),n(H,(t,{product:o})=>m.addOne(o,a(u({},t),{loading:!1}))),n(T,(t,{error:o})=>a(u({},t),{error:o,loading:!1})),n(y,(t,{product:o})=>m.addOne(o,t)),n(U,(t,{product:o})=>m.updateOne({id:o._id,changes:o},t)),n(w,(t,{productId:o})=>m.removeOne(o,t)));export{At as a,xt as b};
